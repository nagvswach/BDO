TP07

1.
SELECT spj.ID_J,SUM(spj.QTY) SUM
FROM spj 
JOIN j ON j.ID_J=spj.ID_J
WHERE j.CITY = 'Athens'
GROUP BY j.ID_J
HAVING SUM(spj.QTY) > 1000;

2.
SELECT spj.ID_P,spj.ID_J
FROM spj 
GROUP BY spj.ID_P,spj.ID_J
HAVING AVG(spj.QTY) > 320;

3.
SELECT DISTINCT spj.ID_S
FROM spj li
GROUP BY li.ID_S, li.ID_p
HAVING COUNT(spj.QTY) >= 3;

4.
SELECT  ID_P
FROM SPJ
GROUP BY ID_P
HAVING COUNT(DISTINCT ID_S) >= 2;

5.
SELECT DISTINCT spj.ID_P
FROM spj
GROUP BY spj.ID_J,spj.ID_P
HAVING COUNT(DISTINCT ID_S) >= 2;

6.
SELECT spj.ID_P,SUM(SPJ.QTY)
FROM spj 
GROUP BY spj.ID_P
HAVING COUNT(SPJ.ID_P) > 3;